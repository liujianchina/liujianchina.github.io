<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>SpringCloud组件03---Hystrix实践 | 树先生的博客</title>
  <meta name="description" content="RxJava快速入门  基本概念 创建流程  Observer观察者 Observable 被观察者(事件源)     简介 概念  服务熔断 服务降级  熔断、降级的关系 降级方式   服务限流 如何实现的：  上图的步骤   隔离的实现  线程池隔离模式： 信号量隔离模式：   熔断   Hystrix源码  HystrixCommand类图 HystrixObservableComm">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringCloud组件03---Hystrix实践">
<meta property="og:url" content="https://blog.sofunnyai.com/article/springcloud-H-03-hystrix.html">
<meta property="og:site_name" content="树先生的金融风控工程师博客">
<meta property="og:description" content="RxJava快速入门  基本概念 创建流程  Observer观察者 Observable 被观察者(事件源)     简介 概念  服务熔断 服务降级  熔断、降级的关系 降级方式   服务限流 如何实现的：  上图的步骤   隔离的实现  线程池隔离模式： 信号量隔离模式：   熔断   Hystrix源码  HystrixCommand类图 HystrixObservableComm">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/radio/pics/raw/master/img/image-20200603184440919.png">
<meta property="og:image" content="https://blog.sofunnyai.com/home/tree/.config/Typora/typora-user-images/image-20200602153749926.png">
<meta property="og:image" content="https://gitee.com/radio/pics/raw/master/img/image-20200602153858394.png">
<meta property="og:image" content="https://gitee.com/radio/pics/raw/master/img/image-20200602151354011.png">
<meta property="og:image" content="https://gitee.com/radio/pics/raw/master/img/image-20200602153259821.png">
<meta property="og:image" content="https://gitee.com/radio/pics/raw/master/img/image-20200602153404090.png">
<meta property="og:image" content="https://gitee.com/radio/pics/raw/master/img/4115139-5443e70eedb3c6ef.png">
<meta property="og:image" content="https://gitee.com/radio/pics/raw/master/img/image-20200603115730422.png">
<meta property="og:image" content="https://gitee.com/radio/pics/raw/master/img/image-20200603160553985.png">
<meta property="og:image" content="https://gitee.com/radio/pics/raw/master/img/image-20200604002958416.png">
<meta property="og:image" content="https://gitee.com/radio/pics/raw/master/img/image-20200604093738685.png">
<meta property="article:published_time" content="2020-03-23T09:34:41.000Z">
<meta property="article:modified_time" content="2020-06-15T03:13:17.201Z">
<meta property="article:author" content="树先生">
<meta property="article:tag" content="SpringCloud">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/radio/pics/raw/master/img/image-20200603184440919.png">
  <!-- Canonical links -->
  <link rel="canonical" href="https://blog.sofunnyai.com/article/springcloud-H-03-hystrix.html">
  
    <link rel="alternate" href="/atom.xml" title="树先生的金融风控工程师博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1.4.0/dist/gitalk.min.css">
  
<meta name="generator" content="Hexo 4.2.1"></head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="" target="_blank">
          <img class="img-circle img-rotate" src="/images/cartoon_header.jpeg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">树先生</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">Risk Control Engineer</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Beijing, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">标签</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="/atom.xml" target="_blank" title="Rss" ><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>欢迎讨论金融风控业务和工程技巧</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/DesignPattern/">DesignPattern</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/IO/">IO</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpringCloud/">SpringCloud</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/interview/">interview</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ml/">ml</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/network/">network</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/private/">private</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/risk/">risk</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/spring/">spring</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/v2/">v2</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/xx/">xx</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/">多线程</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B9%B6%E5%8F%91/">并发</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%A1%86%E6%9E%B6/">框架</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签</h3>
    <div class="widget-body">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/DesignPattern/" rel="tag">DesignPattern</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring/" rel="tag">Spring</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringCloud/" rel="tag">SpringCloud</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/aop/" rel="tag">aop</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cck/" rel="tag">cck</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/interview/" rel="tag">interview</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jdk/" rel="tag">jdk</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/" rel="tag">mysql</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/note/" rel="tag">note</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/private/" rel="tag">private</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/risk/" rel="tag">risk</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/" rel="tag">spring</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/strategy/" rel="tag">strategy</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tag1/" rel="tag">tag1</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tag2/" rel="tag">tag2</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/v2/" rel="tag">v2</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" rel="tag">中间件</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%BA%E7%A1%80/" rel="tag">基础</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" rel="tag">多线程</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%B6%E5%8F%91/" rel="tag">并发</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" rel="tag">并发编程</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag">机器学习</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A1%86%E6%9E%B6/" rel="tag">框架</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%90%E7%A0%81/" rel="tag">源码</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B/" rel="tag">特征工程</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag">网络</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AF%84%E5%88%86%E5%8D%A1/" rel="tag">评分卡</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%90%E7%BB%B4/" rel="tag">运维</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%97%B2%E6%9D%82/" rel="tag">闲杂</a><span class="tag-list-count">2</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签云</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/DesignPattern/" style="font-size: 13.2px;">DesignPattern</a> <a href="/tags/Spring/" style="font-size: 13.2px;">Spring</a> <a href="/tags/SpringBoot/" style="font-size: 13px;">SpringBoot</a> <a href="/tags/SpringCloud/" style="font-size: 13.4px;">SpringCloud</a> <a href="/tags/aop/" style="font-size: 13px;">aop</a> <a href="/tags/cck/" style="font-size: 13px;">cck</a> <a href="/tags/hexo/" style="font-size: 13.4px;">hexo</a> <a href="/tags/interview/" style="font-size: 13px;">interview</a> <a href="/tags/java/" style="font-size: 14px;">java</a> <a href="/tags/jdk/" style="font-size: 13px;">jdk</a> <a href="/tags/mysql/" style="font-size: 13px;">mysql</a> <a href="/tags/note/" style="font-size: 13px;">note</a> <a href="/tags/private/" style="font-size: 13.4px;">private</a> <a href="/tags/risk/" style="font-size: 13.6px;">risk</a> <a href="/tags/spring/" style="font-size: 13.4px;">spring</a> <a href="/tags/strategy/" style="font-size: 13px;">strategy</a> <a href="/tags/tag1/" style="font-size: 13px;">tag1</a> <a href="/tags/tag2/" style="font-size: 13px;">tag2</a> <a href="/tags/v2/" style="font-size: 13px;">v2</a> <a href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" style="font-size: 13.2px;">中间件</a> <a href="/tags/%E5%9F%BA%E7%A1%80/" style="font-size: 13.2px;">基础</a> <a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 13.8px;">多线程</a> <a href="/tags/%E5%B9%B6%E5%8F%91/" style="font-size: 13.6px;">并发</a> <a href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" style="font-size: 13px;">并发编程</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 13px;">数据结构</a> <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" style="font-size: 13px;">机器学习</a> <a href="/tags/%E6%A1%86%E6%9E%B6/" style="font-size: 13px;">框架</a> <a href="/tags/%E6%BA%90%E7%A0%81/" style="font-size: 13.2px;">源码</a> <a href="/tags/%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B/" style="font-size: 13.2px;">特征工程</a> <a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 13.2px;">网络</a> <a href="/tags/%E8%AF%84%E5%88%86%E5%8D%A1/" style="font-size: 13.4px;">评分卡</a> <a href="/tags/%E8%BF%90%E7%BB%B4/" style="font-size: 13.2px;">运维</a> <a href="/tags/%E9%97%B2%E6%9D%82/" style="font-size: 13.2px;">闲杂</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">归档</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/09/">九月 2009</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/1970/06/">六月 1970</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/risk/">risk</a>
              </p>
              <p class="item-title">
                <a href="/article/strategy.html" class="title">风控策略相关的一切</a>
              </p>
              <p class="item-date">
                <time datetime="2020-04-15T06:37:22.000Z" itemprop="datePublished">2020-04-15</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/SpringCloud/">SpringCloud</a>
              </p>
              <p class="item-title">
                <a href="/article/springcloud-H-03-hystrix.html" class="title">SpringCloud组件03---Hystrix实践</a>
              </p>
              <p class="item-date">
                <time datetime="2020-03-23T09:34:41.000Z" itemprop="datePublished">2020-03-23</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/SpringCloud/">SpringCloud</a>
              </p>
              <p class="item-title">
                <a href="/article/springcloud-H-02-open-feign.html" class="title">SpringCloud组件02---OpenFeign实践</a>
              </p>
              <p class="item-date">
                <time datetime="2020-03-22T04:22:51.000Z" itemprop="datePublished">2020-03-22</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/risk/">risk</a>
              </p>
              <p class="item-title">
                <a href="/article/vintage_rollrate_fpd.html" class="title">互联网金融资产质量评估指标---fpd、vintage、rollrate和迁移率等等</a>
              </p>
              <p class="item-date">
                <time datetime="2020-03-21T17:25:33.000Z" itemprop="datePublished">2020-03-22</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/SpringCloud/">SpringCloud</a>
              </p>
              <p class="item-title">
                <a href="/article/springcloud-H-01-eureka-ribbon.html" class="title">SpringCloud组件01---CAP、注册中心、Ribbon实践</a>
              </p>
              <p class="item-date">
                <time datetime="2020-03-02T14:30:40.000Z" itemprop="datePublished">2020-03-02</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<main class="main" role="main">
  <div class="content">
  <article id="post-springcloud03-hystrix" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      SpringCloud组件03---Hystrix实践
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/article/springcloud-H-03-hystrix.html" class="article-date">
	  <time datetime="2020-03-23T09:34:41.000Z" itemprop="datePublished">2020-03-23</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/SpringCloud/">SpringCloud</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link" href="/tags/SpringCloud/" rel="tag">SpringCloud</a>
  </span>


        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill" aria-hidden="true"></i>
	    <span id="busuanzi_container_page_pv">
			<span id="busuanzi_value_page_pv">0</span>
		</span>
	</span>


        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/article/springcloud-H-03-hystrix.html#comments" class="article-comment-link">评论</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <!--此处生成目录-->
<div class="toc">
<!-- toc -->
<ul>
<li><a href="#rxjava-kuai-su-ru-men">RxJava快速入门</a>
<ul>
<li><a href="#ji-ben-gai-nian">基本概念</a></li>
<li><a href="#chuang-jian-liu-cheng">创建流程</a>
<ul>
<li><a href="#observer-guan-cha-zhe">Observer观察者</a></li>
<li><a href="#observable-bei-guan-cha-zhe-shi-jian-yuan">Observable 被观察者(事件源)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#jian-jie">简介</a></li>
<li><a href="#gai-nian">概念</a>
<ul>
<li><a href="#fu-wu-rong-duan">服务熔断</a></li>
<li><a href="#fu-wu-jiang-ji">服务降级</a>
<ul>
<li><a href="#rong-duan-jiang-ji-de-guan-xi">熔断、降级的关系</a></li>
<li><a href="#jiang-ji-fang-shi">降级方式</a></li>
</ul>
</li>
<li><a href="#fu-wu-xian-liu">服务限流</a></li>
<li><a href="#ru-he-shi-xian-de">如何实现的：</a>
<ul>
<li><a href="#shang-tu-de-bu-zou">上图的步骤</a></li>
</ul>
</li>
<li><a href="#ge-chi-de-shi-xian">隔离的实现</a>
<ul>
<li><a href="#xian-cheng-chi-ge-chi-mo-shi">线程池隔离模式：</a></li>
<li><a href="#xin-hao-liang-ge-chi-mo-shi">信号量隔离模式：</a></li>
</ul>
</li>
<li><a href="#rong-duan">熔断</a></li>
</ul>
</li>
<li><a href="#hystrix-yuan-ma">Hystrix源码</a>
<ul>
<li><a href="#hystrixcommand-lei-tu">HystrixCommand类图</a></li>
<li><a href="#hystrixobservablecommand-lei-tu">HystrixObservableCommand类图</a>
<ul>
<li><a href="#hystrixcommand-he-hystrixobservablecommand">HystrixCommand和HystrixObservableCommand</a></li>
</ul>
</li>
<li><a href="#duan-lu-qi-hystrixcircuitbreaker">断路器HystrixCircuitBreaker</a></li>
<li><a href="#ge-chi">隔离</a></li>
</ul>
</li>
<li><a href="#pei-zhi-can-shu">配置参数</a></li>
</ul>
<!-- tocstop -->
</div>
<p>因为Hystrix大量使用到观察者模式和RxJava，所以需要补充相关知识。</p>
<p>观察者模式可以看这里：《》</p>
<p>下面是RxJava的快速入门</p>
<h1><span id="rxjava-kuai-su-ru-men"> RxJava快速入门</span><a href="#rxjava-kuai-su-ru-men" class="header-anchor">#</a></h1>
<h2><span id="ji-ben-gai-nian"> 基本概念</span><a href="#ji-ben-gai-nian" class="header-anchor">#</a></h2>
<p>RxJava 有四个基本概念：</p>
<ul>
<li>
<p><code>Observable</code> (可观察者，即<strong>被观察者</strong>)、 <code>Observer</code> (观察者)、 <code>subscribe</code> (订阅)、<code>Event</code>事件。<code>Observable</code> 和 <code>Observer</code> 通过 <code>subscribe()</code> 方法实现订阅关系，从而 <code>Observable</code> 可以在需要的时候发出事件来通	知 <code>Observer</code>。这里的事件就是对依赖的服务进行调用。</p>
</li>
<li>
<p>一个Observable可以发出多个事件，直到结束或者发生异常。</p>
</li>
<li>
<p><code>Observable</code>每次发出一个事件就会调用<code>Subscriber</code>对象的<code>onNext()</code>方法。</p>
</li>
<li>
<p>每一个Observable的执行，最后都会通过调用一个<code>Subscriber.onComplete()</code>或者<code>Subscriber.onError()</code>结束事件的操作流。</p>
</li>
<li>
<p>RxJava 的事件回调方法除了普通事件 <code>onNext()</code> （相当于 <code>onClick()</code> / <code>onEvent()</code>）之外，还定义了两个特殊的事件：<code>onCompleted()</code> 和 <code>onError()</code>。</p>
</li>
<li>
<p><code>onCompleted()</code>: <strong>事件队列完结</strong>。RxJava 不仅把每个事件单独处理，还会把它们看做一个队列。RxJava 规定，当不会再有新的 <code>onNext()</code> 发出时，需要触发 <code>onCompleted()</code> 方法作为标志。</p>
</li>
<li>
<p><code>onError()</code>: <strong>事件队列异常</strong>。在事件处理过程中出异常时，<code>onError()</code> 会被触发，同时队列自动终止，不允许再有事件发出。</p>
</li>
<li>
<p>在一个正确运行的事件序列中, <code>onCompleted()</code> 和 <code>onError()</code> <strong>有且只有一个</strong>，并且<strong>是事件序列中的最后一个</strong>。需要注意的是，<code>onCompleted()</code> 和 <code>onError()</code> 二者也是<strong>互斥</strong>的，即在队列中调用了其中一个，就不应该再调用另一个。</p>
<p><img src="https://gitee.com/radio/pics/raw/master/img/image-20200603184440919.png" alt="image-20200603184440919"></p>
</li>
</ul>
<h2><span id="chuang-jian-liu-cheng"> 创建流程</span><a href="#chuang-jian-liu-cheng" class="header-anchor">#</a></h2>
<h3><span id="observer-guan-cha-zhe"> Observer观察者</span><a href="#observer-guan-cha-zhe" class="header-anchor">#</a></h3>
<p>观察者，它决定事件触发的时候将<strong>有怎样的行为</strong>。有两种方式，直接创建<code>Observer</code>接口，或者从抽象类<code>Subscriber</code>实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Observer&lt;String&gt; observer = <span class="keyword">new</span> Observer&lt;String&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        Log.d(tag, <span class="string">"Item: "</span> + s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompleted</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Log.d(tag, <span class="string">"Completed!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</span><br><span class="line">        Log.d(tag, <span class="string">"Error!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><code>Subscriber</code>和上面的<code>Observer</code>二者只是抽象类提供了更多的拓展方法（<code>onStart</code>和<code>unsubscribe</code>）而已，创建过程是一样的。</p>
<h3><span id="observable-bei-guan-cha-zhe-shi-jian-yuan"> Observable 被观察者(事件源)</span><a href="#observable-bei-guan-cha-zhe-shi-jian-yuan" class="header-anchor">#</a></h3>
<p>决定<strong>什么时候触发事件</strong>以及<strong>触发怎样的事件</strong>。 RxJava 使用 <code>create()</code> 方法来创建一个 Observable ，并为它定义事件触发规则：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Observable observable = Observable.create(<span class="keyword">new</span> Observable.OnSubscribe&lt;String&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Subscriber&lt;? <span class="keyword">super</span> String&gt; subscriber)</span> </span>&#123;</span><br><span class="line">        subscriber.onNext(<span class="string">"Hello"</span>);</span><br><span class="line">        subscriber.onNext(<span class="string">"Hi"</span>);</span><br><span class="line">        subscriber.onNext(<span class="string">"Aloha"</span>);</span><br><span class="line">        subscriber.onCompleted();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>可以看到，这里传入了一个 <code>OnSubscribe</code> 对象作为参数。<code>OnSubscribe</code> 会被存储在返回的 <code>Observable</code> 对象中，它的作用相当于一个计划表:</p>
<ul>
<li>
<p><strong>当 <code>Observable</code> 被订阅的时候，<code>OnSubscribe</code> 的 <code>call()</code> 方法会自动被调用</strong></p>
</li>
<li>
<p>事件序列就会依照设定依次触发（对于上面的代码，就是观察者<code>Subscriber</code> 将会被调用三次 <code>onNext()</code> 和一次 <code>onCompleted()</code>）。</p>
</li>
<li>
<p>这样，由被观察者调用了观察者的回调方法，就实现了由被观察者向观察者的事件传递，即观察者模式。</p>
</li>
</ul>
<blockquote>
<p>这里只是最简单的一个例子，事件的内容是字符串，而不是一些复杂的对象；事件的内容是已经定好了的，而不像有的观察者模式一样是待确定的（例如网络请求的结果在请求返回之前是未知的）；所有事件在一瞬间被全部发送出去，而不是夹杂一些确定或不确定的时间间隔或者经过某种触发器来触发的。</p>
</blockquote>
<h1><span id="jian-jie"> 简介</span><a href="#jian-jie" class="header-anchor">#</a></h1>
<p>官网</p>
<blockquote>
<p><a href="https://github.com/Netflix/hystrix" target="_blank" rel="noopener">https://github.com/Netflix/hystrix</a></p>
</blockquote>
<p>因为调用链路越来越长，当某个微服务挂了，可能造成整个调用链路的请求拥挤和挂起，导致更多服务down掉，最终形成服务雪崩。</p>
<p>Hystrix是用于处理分布式系统的<strong>延迟</strong>和<strong>容错</strong>开源库，在超时、异常等场景下，Hystrix保证在一个依赖出问题的情况下，不会导致整体集群集体失败、避免级联故障、提高分布式系统的弹性</p>
<p>断路器是一种开关装置。实现快速失败，<strong>服务失败后，通过服务的故障监控，向调用方发送一个预期的、可处理的备选FallBack反馈，而不是长时间挂起或者抛出异常。</strong></p>
<p>这样保证了服务调用方的线程不会长时间挂起、不必要的等待，避免了故障的蔓延和雪崩。</p>
<p>造成雪崩原因可以归结为以下三个：</p>
<ul>
<li>服务提供者不可用（硬件故障，程序Bug，缓存击穿，用户大量请求）</li>
<li>重试加大流量（用户重试，代码逻辑重试）</li>
<li>服务调用者不可用（同步等待造成的资源耗尽）</li>
</ul>
<p>最终的结果就是一个服务不可用导致一系列服务的不可用，而往往这种后果往往无法预料的。</p>
<h1><span id="gai-nian"> 概念</span><a href="#gai-nian" class="header-anchor">#</a></h1>
<h2><span id="fu-wu-rong-duan"> 服务熔断</span><a href="#fu-wu-rong-duan" class="header-anchor">#</a></h2>
<p>一般是指软件系统中，<strong>由于某些原因使得服务出现了过载现象，为防止造成整个系统故障，从而采用的一种保护措施</strong>，所以很多地方把熔断亦称为过载保护。</p>
<h2><span id="fu-wu-jiang-ji"> 服务降级</span><a href="#fu-wu-jiang-ji" class="header-anchor">#</a></h2>
<p>划分优先级，忍痛割爱。整体资源快不够了，忍痛将某些服务先关掉，待渡过难关，再开启回来。对方不可用的时候，给一个可预期的备选兜底FallBack。</p>
<p>什么时候会降级：<strong>程序异常/超时/熔断触发/线程池、信号量打满</strong></p>
<p>要在<strong>调用方做降级</strong>（不然那个微服务都down掉了再做降级也没什么意义了） 比如说我们 user 调用payment 那么就在user 做降级.</p>
<h3><span id="rong-duan-jiang-ji-de-guan-xi"> 熔断、降级的关系</span><a href="#rong-duan-jiang-ji-de-guan-xi" class="header-anchor">#</a></h3>
<p>二者的目标是一致的，目的都是保证上游服务的稳定性。但其关注的重点并不一样，融断对下层依赖的服务并不级（或者说孰轻孰重），一旦产生故障就断掉；而降级需要对下层依赖的业务分级，把产生故障的丢了，换一个轻量级的方案，是一种退而求其次的方法。<br>
根据业务场景的不同，一般采用以下两种模式：</p>
<h3><span id="jiang-ji-fang-shi"> 降级方式</span><a href="#jiang-ji-fang-shi" class="header-anchor">#</a></h3>
<p>第一种（最常用）如果服务失败，则我们通过fallback进行降级，返回静态值。</p>
<ul>
<li>fallback进行降级，返回静态值：</li>
</ul>
<p><img src="../../../../home/tree/.config/Typora/typora-user-images/image-20200602153749926.png" alt="image-20200602153749926"></p>
<ul>
<li>级联方式降级：</li>
</ul>
<p>如果第一个服务失败，则调用备用服务，例如失败重试或者访问缓存失败再去取数据库。</p>
<p>服务级联的目的则是尽最大努力保证返回数据的成功性，但如果考虑不充分，则有可能导致级联的服务崩溃（比如，缓存失败了，把全部流量打到数据库，瞬间导致数据库挂掉）。</p>
<p>因此级联模式，也要慎用，增加了管理的难度。</p>
<p><img src="https://gitee.com/radio/pics/raw/master/img/image-20200602153858394.png" alt="image-20200602153858394"></p>
<p>Hystrix执行以下操作：</p>
<ul>
<li>提供保护并控制通过第三方客户端库访问（通常是通过网络）的依赖项带来的延迟和失败。</li>
<li>停止复杂的分布式系统中的级联故障。</li>
<li>快速失败并快速恢复。</li>
<li>FallBack回退并在可能的情况下正常降级。</li>
<li>启用近乎实时的监视，警报和操作控制。</li>
</ul>
<p>Hystrix的工作原理：</p>
<ul>
<li>防止任何单个依赖项耗尽所有容器（例如Tomcat）用户线程。</li>
<li>减少负载并快速失败，而不是排队。</li>
<li>在可行的情况下提供备用，以保护用户免受故障的影响。</li>
<li>隔离：例如隔板bulkhead，泳道swimlane和断路器模式circuit breaker patterns，（线程池隔离和信号量隔离）限制调用分布式服务的资源使用，某一个调用的服务出现问题不会影响其他服务调用。</li>
<li>降级机制：超时降级、资源不足时(线程或信号量)降级，降级后可以配合降级接口返回托底数据。</li>
<li>融断：当失败率达到阀值自动触发降级(如因网络故障/超时造成的失败率高)，熔断器触发的快速失败会进行快速恢复。</li>
<li>缓存：提供了请求缓存、请求合并实现。</li>
<li>通过近实时监控指标，警报优化</li>
</ul>
<h2><span id="fu-wu-xian-liu"> 服务限流</span><a href="#fu-wu-xian-liu" class="header-anchor">#</a></h2>
<p>秒杀等高并发场景，严禁一窝蜂，需要排队，一秒钟只能N个有序运行。</p>
<h2><span id="ru-he-shi-xian-de"> 如何实现的：</span><a href="#ru-he-shi-xian-de" class="header-anchor">#</a></h2>
<ul>
<li>
<p>将对外部系统（或“依赖项”）的所有调用包装在通常在单独线程中执行的HystrixCommand或HystrixObservableCommand对象中（这是命令模式的示例）。</p>
</li>
<li>
<p>超时调用时间阈值。 有默认值，但可以自定义为超过99.5％的调用时间。</p>
</li>
<li>
<p>为每个依赖项维护一个小的线程池（或信号量）； 如果已满，发往该依赖项的请求将立即被拒绝，而不是排队。</p>
</li>
<li>
<p>测量成功，失败（客户端抛出的异常），超时和线程拒绝。</p>
</li>
<li>
<p>如果某个服务的错误百分比超过阈值，则使断路器跳闸，以在一段时间内手动或自动停止所有对特定服务的请求。</p>
</li>
<li>
<p>当请求失败，被拒绝，超时或短路时执行回退逻辑。</p>
</li>
<li>
<p>几乎实时监控指标和配置更改。</p>
<p>更多见：</p>
</li>
</ul>
<blockquote>
<p><a href="https://github.com/Netflix/Hystrix/wiki/How-it-Works#flow1" target="_blank" rel="noopener">https://github.com/Netflix/Hystrix/wiki/How-it-Works#flow1</a></p>
</blockquote>
<p><img src="https://gitee.com/radio/pics/raw/master/img/image-20200602151354011.png" alt="image-20200602151354011"></p>
<h3><span id="shang-tu-de-bu-zou"> 上图的步骤</span><a href="#shang-tu-de-bu-zou" class="header-anchor">#</a></h3>
<ol>
<li>
<p>构造一个<code>HystrixCommand</code>或<code>HystrixObservableCommand</code>对象</p>
</li>
<li>
<p>执行命令，有四种方式。分别可以返回单个和多个返回。<code>HystrixObservableCommand</code>两个方法分别获取Hot和Cold的Observable。</p>
</li>
<li>
<p>响应是否已缓存：如果为此命令启用了请求缓存，并且如果对请求的响应在缓存中可用，则该缓存的响应将立即以的形式返回<code>Observable</code>。</p>
</li>
<li>
<p>断路器是否开启：当执行该命令时，Hystrix会检查断路器，以查看断路器是否断开。</p>
<p>如果断开（或“跳闸”），那么Hystrix将不执行命令，而是将流路由到（8）获取回退。如果电路是闭合的，则流程进行到（5），以检查是否有足够的容量来运行该命令。</p>
</li>
<li>
<p>线程池/队列/信号量是否已满：如果与该命令关联的线程池和队列（或信号量，如果未在线程中运行）已满，则Hystrix将不执行该命令，但会立即将流路由到（8）获取回退。</p>
</li>
<li>
<p><code>HystrixObservableCommand.construct()</code>或<code>HystrixCommand.run()</code>，run返回单个响应或引发异常。construct返回一个Observable，它发出响应或发送<code>onError</code>通知。</p>
</li>
<li>
<p>计算电路健康度：Hystrix向断路器报告成功，失败，拒绝和超时，断路器保持滚动的一组计算统计信息的计数器。它使用这些统计信息来确定电路何时应“跳闸”，在此点它会将随后的所有请求短路，直到经过恢复期为止，在此之后，在首先检查某些运行状况检查之后，它将再次闭合电路。</p>
</li>
<li>
<p>获取后备：<a href="#%E4%B8%A4%E4%B8%AA%E5%A4%84%E7%90%86%E9%99%8D%E7%BA%A7%E7%9A%84%E7%B1%BB%E5%8C%BA%E5%88%AB%EF%BC%9A">两个处理降级的类区别：</a></p>
<ol>
<li>
<p>construct或者run引发异常</p>
</li>
<li>
<p>断路器断开</p>
</li>
<li>
<p>线程池或者信号量满了</p>
</li>
<li>
<p>命令时间超时</p>
<p><code>HystrixCommand.getFallback()</code>或者<code>HystrixObservableCommand.resumeWithFallback()</code>进行后备实现，最终的后备应该不依赖网络静态，否则会级联失败。</p>
<p>如果没准备后备，缺省抛出异常，会到OnError通知，非常糟糕要避免。</p>
</li>
</ol>
</li>
<li>
<p>获取成功后的响应：参见 <a href="#%E4%B8%A4%E4%B8%AA%E5%A4%84%E7%90%86%E9%99%8D%E7%BA%A7%E7%9A%84%E7%B1%BB%E5%8C%BA%E5%88%AB%EF%BC%9A">HystrixCommand和HystrixObservableCommand两个处理降级的类区别</a></p>
</li>
</ol>
<blockquote>
<p>这里有一个关联源码的动态序列图   <a href="https://design.codelytics.io/hystrix/how-it-works" target="_blank" rel="noopener">https://design.codelytics.io/hystrix/how-it-works</a></p>
</blockquote>
<p>降级出现的场景：</p>
<ul>
<li>上图4，命令处于“熔断、短路”状态的时候</li>
<li>上图5，当前命令的线程池、请求队列或者信号量被占满的时候。</li>
<li>上图6，当<code>HystrixObservableCommand.construct()</code>或者<code>HystrixCommand.run()</code>发生异常的时候。</li>
</ul>
<h2><span id="ge-chi-de-shi-xian"> 隔离的实现</span><a href="#ge-chi-de-shi-xian" class="header-anchor">#</a></h2>
<h3><span id="xian-cheng-chi-ge-chi-mo-shi"> 线程池隔离模式：</span><a href="#xian-cheng-chi-ge-chi-mo-shi" class="header-anchor">#</a></h3>
<p>使用一个线程池来存储当前的请求，线程池对请求作处理，设置任务返回处理超时时间，堆积的请求堆积入线程池队列。这种方式需要为每个依赖的服务申请线程池，有一定的资源消耗，好处是可以应对突发流量（流量洪峰来临时，处理不完可将数据存储到线程池队里慢慢处理）</p>
<h3><span id="xin-hao-liang-ge-chi-mo-shi"> 信号量隔离模式：</span><a href="#xin-hao-liang-ge-chi-mo-shi" class="header-anchor">#</a></h3>
<p>使用一个原子计数器（或信号量）来记录当前有多少个线程在运行，请求来先判断计数器的数值，若超过设置的最大线程个数则丢弃改类型的新请求，若不超过则执行计数操作请求来计数器+1，请求返回计数器-1。这种方式是严格的控制线程且立即返回模式，无法应对突发流量（流量洪峰来临时，处理的线程超过数量，其他的请求会直接返回，不继续去请求依赖的服务）</p>
<p>区别（两种隔离方式只能选其一）：</p>
<table>
<thead>
<tr>
<th></th>
<th>线程池隔离</th>
<th>信号量隔离</th>
</tr>
</thead>
<tbody>
<tr>
<td>线程</td>
<td>与调用线程非相同线程</td>
<td>与调用线程相同（jetty线程）</td>
</tr>
<tr>
<td>开销</td>
<td>排队、调度、上下文开销等</td>
<td>无线程切换，开销低</td>
</tr>
<tr>
<td>异步</td>
<td>支持</td>
<td>不支持</td>
</tr>
<tr>
<td>并发支持</td>
<td>支持（最大线程池大小）</td>
<td>支持（最大信号量上限）</td>
</tr>
</tbody>
</table>
<p><img src="https://gitee.com/radio/pics/raw/master/img/image-20200602153259821.png" alt="image-20200602153259821"></p>
<h2><span id="rong-duan"> 熔断</span><a href="#rong-duan" class="header-anchor">#</a></h2>
<p>正常状态下，电路处于关闭状态(Closed)，如果调用持续出错或者超时，电路被打开进入熔断状态(Open)，后续一段时间内的所有调用都会被拒绝(Fail Fast)，一段时间以后，保护器会尝试进入半熔断状态(Half-Open)，允许少量请求进来尝试，如果调用仍然失败，则回到熔断状态，如果调用成功，则回到电路闭合状态;</p>
<p><img src="https://gitee.com/radio/pics/raw/master/img/image-20200602153404090.png" alt="image-20200602153404090"></p>
<p>HystrixCircuitBreaker（断路器的具体实现），下图是官网How-it-works里面的：</p>
<p><img src="https://gitee.com/radio/pics/raw/master/img/4115139-5443e70eedb3c6ef.png" alt="img"></p>
<p>详细的工作流程：</p>
<blockquote>
<p><a href="http://hot66hot.iteye.com/blog/2155036" target="_blank" rel="noopener">http://hot66hot.iteye.com/blog/2155036</a></p>
</blockquote>
<h1><span id="hystrix-yuan-ma"> Hystrix源码</span><a href="#hystrix-yuan-ma" class="header-anchor">#</a></h1>
<h2><span id="hystrixcommand-lei-tu"> HystrixCommand类图</span><a href="#hystrixcommand-lei-tu" class="header-anchor">#</a></h2>
<p>用于返回一个操作结果</p>
<p>类图，抽象类<code>HystrixCommand</code>继承了<code>AbstractCommand</code>，实现了三个核心接口<code>HystrixExecutable</code>、<code>HystrixInvokableInfo</code>、<code>HystrixObservable</code></p>
<p><img src="https://gitee.com/radio/pics/raw/master/img/image-20200603115730422.png" alt="image-20200603115730422"></p>
<h2><span id="hystrixobservablecommand-lei-tu"> HystrixObservableCommand类图</span><a href="#hystrixobservablecommand-lei-tu" class="header-anchor">#</a></h2>
<p>用于返回多个操作结果对象</p>
<p><img src="https://gitee.com/radio/pics/raw/master/img/image-20200603160553985.png" alt="image-20200603160553985"></p>
<ul>
<li><code>HystrixInvokableInfo</code>是一个空接口，只是一个标记。</li>
<li><code>HystrixInvokable</code>也一样，空接口是一个标记。</li>
</ul>
<h3><span id="hystrixcommand-he-hystrixobservablecommand"> HystrixCommand和HystrixObservableCommand</span><a href="#hystrixcommand-he-hystrixobservablecommand" class="header-anchor">#</a></h3>
<h4><span id="liang-ge-chu-li-jiang-ji-de-lei-qu-bie"> 两个处理降级的类区别：</span><a href="#liang-ge-chu-li-jiang-ji-de-lei-qu-bie" class="header-anchor">#</a></h4>
<ul>
<li>
<p><code>HystrixCommand</code>有2个方法：</p>
<ul>
<li><code>public R execute()</code>： 用于同步执行命令。其实是用queue()返回的Future.get()实现同步。会等待任务执行完毕。</li>
<li><code>public Future&lt;R&gt; queue()</code>：用于异步执行命令。底层是通过 <code>toObservable()</code>拿到一个ColdObservable对象，通过toBlocking()转换为BlockingObservable，它可以把数据通过阻塞的方式发射出去。但是这里使用toFuture()转换成了一个Future返回，不会阻塞。使得消费者可以异步操作。这种转换要求只能发出一个数据，所以execute和queue都只能返回单一结果。</li>
</ul>
</li>
<li>
<p><code>HystrixObservableCommand</code>又提供了2个方法：</p>
<ul>
<li><code>public Observable&lt;R&gt; observe()</code>：返回<code>Observable</code>对象，eagerly的。代表了操作的多个结果。订阅<code>Observable</code>，可用于通过回调异步执行命令。返回的是一个<code>Hot Observable</code>（不管是否有订阅者都会触发事件，每一个订阅者都可能是中途开始的，只看到整个操作的局部）</li>
<li><code>public Observable&lt;R&gt; toObservable()</code>：返回的也是<code>Observable</code>对象，lazily的。代表了操作的多个结果。返回的是一个<code>Cold Observable</code>（会等待，直到有订阅者才开始发布事件，对订阅者保证都是从一开始都看到整个操作的全程。）</li>
<li>Observable可以发送过个数据，获取多个结果。</li>
</ul>
<p><img src="https://gitee.com/radio/pics/raw/master/img/image-20200604002958416.png" alt="image-20200604002958416"></p>
</li>
</ul>
<h4><span id="er-zhe-jiang-ji-de-fang-fa-ye-bu-tong"> 二者降级的方法也不同：</span><a href="#er-zhe-jiang-ji-de-fang-fa-ye-bu-tong" class="header-anchor">#</a></h4>
<ul>
<li><code>HystrixCommand</code>：通过<code>R getFallback()</code>完成降级，直接返回业务R对象。</li>
<li><code>HystrixObservableCommand</code>：通过<code>Observable&lt;R&gt; resumeWithFallback()</code>完成降级，返回Observable对象来发射一个或者多个降级结果。</li>
<li>如果我们没有为命令实现降级方法，缺省实现是抛异常。或者降级失败也会抛异常，最终会进入到<code>onError()</code>方法中因其命令失败，要避免。</li>
</ul>
<p>在服务降级的逻辑中，我们需要一个通用的结果。通常是静态或从缓存中获取的兜底数据，而不是依赖于网络。如果一定要依赖网络，那么依赖的服务也必须放到Hystrix的命令中，级联降级。最终最后兜底的那个一定是一个不依赖于网络的，否则可能降级失败。</p>
<h2><span id="duan-lu-qi-hystrixcircuitbreaker"> 断路器HystrixCircuitBreaker</span><a href="#duan-lu-qi-hystrixcircuitbreaker" class="header-anchor">#</a></h2>
<p>**关键词：**统计值、状态位、CAS、SingleTest、SleepWindow</p>
<p><code>HystrixCircuitBreaker</code>是一个接口，接口文件中有两个实现类<code>HystrixCircuitBreakerImpl</code>和<code>NoOpCircuitBreaker</code>，以及一个Factory。</p>
<p><img src="https://gitee.com/radio/pics/raw/master/img/image-20200604093738685.png" alt="image-20200604093738685"></p>
<ul>
<li>
<p>Factory没啥意思，就是一个CurrentHashMap使用命令的key来缓存和实例化断路器。</p>
</li>
<li>
<p>来看一下缺省断路器实现类<code>HystrixCircuitBreakerImpl</code>就能搞定它的原理了，先大概描述一下再上代码：</p>
<ul>
<li>有四个核心方法：</li>
<li><code>allowRequest()</code>：是否允许访问，主要判断超参数开关。参数设定强制断开、联通的话不回去判断断路器。否则才判断断路器isOpen或者singleTest。没啥意思。</li>
<li><code>isOpen()</code>: true=断开，断开的立刻返回失败。没断开的判断窗口内是否超量(缺省10秒20)，没超量也返回ok。超量的看错误率(缺省50%)超标则标记失败状态(<strong>CAS标识和失败时间</strong>)并返回，否则返回ok。</li>
<li><code>allowSingleTest()</code>：是否允许测一把，在上面isOpen里面如果错误量超标，会CAS标记断开，同时记录断开时间。然后<code>当前请求时间&gt;断开时间+sleepWindow(缺省5秒)</code>后属于<code>半开</code>状态，此时的请求只允许测试一次，成功就恢复，没成功继续修改断开时间。【<strong>也是CAS修改时间戳，保证只会发起一次测试</strong>】</li>
<li><code>markSuccess()</code>：请求成功后就标记成功并清空计数器（<strong>CAS标记成功防止重复清空</strong>）。</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">HystrixCircuitBreakerImpl</span> <span class="keyword">implements</span> <span class="title">HystrixCircuitBreaker</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> HystrixCommandProperties properties;    <span class="comment">//实例化的时候带进来的，一大堆配置参数和开关</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> HystrixCommandMetrics metrics;  <span class="comment">//实例化的时候带进来的，一堆指标</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/* track whether this circuit is open/closed at any given point in time (default to false==closed) */</span></span><br><span class="line">        <span class="keyword">private</span> AtomicBoolean circuitOpen = <span class="keyword">new</span> AtomicBoolean(<span class="keyword">false</span>);  <span class="comment">// true的时候就是open，也就是断路器断开了</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/* when the circuit was marked open or was last allowed to try a 'singleTest' */</span></span><br><span class="line">        <span class="keyword">private</span> AtomicLong circuitOpenedOrLastTestedTime = <span class="keyword">new</span> AtomicLong();   <span class="comment">// 一个时间戳</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="title">HystrixCircuitBreakerImpl</span><span class="params">(HystrixCommandKey key, HystrixCommandGroupKey commandGroup, HystrixCommandProperties properties, HystrixCommandMetrics metrics)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.properties = properties;</span><br><span class="line">            <span class="keyword">this</span>.metrics = metrics;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 标记成功</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">markSuccess</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (circuitOpen.get()) &#123; <span class="comment">//true=open=断开</span></span><br><span class="line">                <span class="keyword">if</span> (circuitOpen.compareAndSet(<span class="keyword">true</span>, <span class="keyword">false</span>)) &#123;   <span class="comment">// 注意使用了CAS避免并发问题，恢复断路器。</span></span><br><span class="line">                    <span class="comment">//win the thread race to reset metrics  // CAS拿到了执行权</span></span><br><span class="line">                    <span class="comment">//Unsubscribe from the current stream to reset the health counts stream.  This only affects the health counts view,  //退订当前流以重置运行状况计数流。这只会影响健康计数相关的信息</span></span><br><span class="line">                    <span class="comment">//and all other metric consumers are unaffected by the reset  //并且所有其他指标使用者均不受重置的影响</span></span><br><span class="line">                    metrics.resetStream();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">allowRequest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (properties.circuitBreakerForceOpen().get()) &#123;  <span class="comment">// 参数里面看看是不是强制断开的，是的话拒绝。</span></span><br><span class="line">                <span class="comment">// properties have asked us to force the circuit open so we will allow NO requests</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (properties.circuitBreakerForceClosed().get()) &#123;    <span class="comment">// 参数里面是不是强制关闭的，是的话允许。</span></span><br><span class="line">                <span class="comment">// we still want to allow isOpen() to perform it's calculations so we simulate normal behavior  // 计数</span></span><br><span class="line">                isOpen();</span><br><span class="line">                <span class="comment">// properties have asked us to ignore errors so we will ignore the results of isOpen and just allow all traffic through</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> !isOpen() || allowSingleTest();    <span class="comment">// 否则看是否闭合，或者是否允许单一测试（单一测试是挂了很久了，再来一个请求允许试一把看看恢复了没）</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//  挂了很久，测一把看看是否恢复了。</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">allowSingleTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">long</span> timeCircuitOpenedOrWasLastTested = circuitOpenedOrLastTestedTime.get();  <span class="comment">// 从Atomic时间戳了拿出来上次失败时间</span></span><br><span class="line">            <span class="comment">// 1) if the circuit is open   // 断路器断开了，而且已经断开了很久，超过了参数配置的睡眠窗口时间。就会允许测试一把</span></span><br><span class="line">            <span class="comment">// 2) and it's been longer than 'sleepWindow' since we opened the circuit</span></span><br><span class="line">            <span class="keyword">if</span> (circuitOpen.get() &amp;&amp; System.currentTimeMillis() &gt; timeCircuitOpenedOrWasLastTested + properties.circuitBreakerSleepWindowInMilliseconds().get()) &#123;</span><br><span class="line">                <span class="comment">// 如果测试成功，就会把断路器合上，恢复服务。否则把失败时间往后赋值，再等下一次时间窗口后进行singleTest</span></span><br><span class="line">                <span class="comment">// We push the 'circuitOpenedTime' ahead by 'sleepWindow' since we have allowed one request to try.</span></span><br><span class="line">                <span class="comment">// If it succeeds the circuit will be closed, otherwise another singleTest will be allowed at the end of the 'sleepWindow'.</span></span><br><span class="line">                <span class="keyword">if</span> (circuitOpenedOrLastTestedTime.compareAndSet(timeCircuitOpenedOrWasLastTested, System.currentTimeMillis())) &#123;</span><br><span class="line">                    <span class="comment">// if this returns true that means we set the time so we'll return true to allow the singleTest</span></span><br><span class="line">                    <span class="comment">// if it returned false it means another thread raced us and allowed the singleTest before we did</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;  <span class="comment">// 允许</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>; <span class="comment">// 另一个线程已经测试了</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">        <span class="comment">// 断路器是否闭合</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isOpen</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (circuitOpen.get()) &#123;</span><br><span class="line">                <span class="comment">// 如果是断开的(true)，我们会立即返回true断开，而不必费心尝试“关闭”自己，因为这允许allowSingleTest和随后的成功测试关闭</span></span><br><span class="line">                <span class="comment">// if we're open we immediately return true and don't bother attempting to 'close' ourself as that is left to allowSingleTest and a subsequent successful test to close</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">             <span class="comment">// 如果我们是闭合的，看一眼是否有错误使我们跳闸，以便使电路断开</span></span><br><span class="line">            <span class="comment">// we're closed, so let's see if errors have made us so we should trip the circuit open</span></span><br><span class="line">            HealthCounts health = metrics.getHealthCounts();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 检查是否超过总统计量的阈值参数，没有超过总量就立即返回false（没断开），不用计算别的</span></span><br><span class="line">            <span class="comment">// check if we are past the statisticalWindowVolumeThreshold</span></span><br><span class="line">            <span class="keyword">if</span> (health.getTotalRequests() &lt; properties.circuitBreakerRequestVolumeThreshold().get()) &#123;</span><br><span class="line">                <span class="comment">// we are not past the minimum volume threshold for the statisticalWindow so we'll return false immediately and not calculate anything</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果超过了总量，再来计算错误比例</span></span><br><span class="line">            <span class="keyword">if</span> (health.getErrorPercentage() &lt; properties.circuitBreakerErrorThresholdPercentage().get()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;   <span class="comment">// 错误比例没超标，直接返回ok的，没断开</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// our failure rate is too high, trip the circuit</span></span><br><span class="line">                <span class="keyword">if</span> (circuitOpen.compareAndSet(<span class="keyword">false</span>, <span class="keyword">true</span>)) &#123;    <span class="comment">// 错误率太高，CAS把断路器关闭掉。CAS成功的话</span></span><br><span class="line">                    <span class="comment">// if the previousValue was false then we want to set the currentTime</span></span><br><span class="line">                    circuitOpenedOrLastTestedTime.set(System.currentTimeMillis());    <span class="comment">// 设置断路时间</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;   <span class="comment">// 返回断路了</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// How could previousValue be true? If another thread was going through this code at the same time a race-condition could have</span></span><br><span class="line">                    <span class="comment">// caused another thread to set it to true already even though we were in the process of doing the same</span></span><br><span class="line">                    <span class="comment">// In this case, we know the circuit is open, so let the other thread set the currentTime and report back that the circuit is open</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;   <span class="comment">// 这里是被别的CAS抢占了，但是也要告诉当前的调用者这次是断开的。</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h2><span id="ge-chi"> 隔离</span><a href="#ge-chi" class="header-anchor">#</a></h2>
<h1><span id="pei-zhi-can-shu"> 配置参数</span><a href="#pei-zhi-can-shu" class="header-anchor">#</a></h1>
<p>很多参数，去这里查：</p>
<blockquote>
<p><a href="https://github.com/Netflix/Hystrix/wiki/Configuration" target="_blank" rel="noopener">https://github.com/Netflix/Hystrix/wiki/Configuration</a></p>
</blockquote>
<blockquote>
<p><a href="https://www.jianshu.com/p/e07661b9bae8" target="_blank" rel="noopener">https://www.jianshu.com/p/e07661b9bae8</a></p>
<p><a href="https://www.jianshu.com/p/3e11ac385c73uyi" target="_blank" rel="noopener">https://www.jianshu.com/p/3e11ac385c73uyi</a></p>
</blockquote>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="https://blog.sofunnyai.com/article/springcloud-H-03-hystrix.html" title="SpringCloud组件03---Hystrix实践" target="_blank" rel="external">https://blog.sofunnyai.com/article/springcloud-H-03-hystrix.html</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/cartoon_header.jpeg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="" target="_blank"><span class="text-dark">树先生</span><small class="ml-1x">Risk Control Engineer</small></a></h3>
        <div>一个金融风控软件工程师。</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
           
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/article/strategy.html" title="风控策略相关的一切"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/article/springcloud-H-02-open-feign.html" title="SpringCloud组件02---OpenFeign实践"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
  </ul>
  
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div>
    
  </div>
  </div>
</nav>
  


</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="/atom.xml" target="_blank" title="Rss" ><i class="icon icon-rss"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <!--div class="publishby">
        	Theme by <a href="#" target="_blank"> . </a>base on <a href="#">pure</a>.
        </div-->
       <div>
         <span id="busuanzi_container_site_pv">
            本站总访问量<span id="busuanzi_value_site_pv"></span>次
         </span>
       </div>
    </div>
</footer>

  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





   
    
  <!-- <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"> -->
  <script src="//cdn.jsdelivr.net/npm/gitalk@1.4.0/dist/gitalk.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script>
  <script type="text/javascript">
  var gitalk = new Gitalk({
    clientID: '37d6fe220531a0253492',
    clientSecret: 'b20bb830af693e7d62e5efe08048c9d42234ba2f',
    repo: 'liujianchina.github.io',
    owner: 'liujianchina',
    admin: ['liujianchina'],
    id: md5(location.pathname),
    distractionFreeMode: true
  })
  gitalk.render('comments')
  </script>

      







</body>
</html>