<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>树先生的金融风控工程师博客</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.sofunnyai.com/"/>
  <updated>2020-05-20T07:15:39.489Z</updated>
  <id>https://blog.sofunnyai.com/</id>
  
  <author>
    <name>树先生</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Hexo+Github+自定义域名+CDN部署</title>
    <link href="https://blog.sofunnyai.com/2018/07/16/build-a-blog-base-hexo-github/"/>
    <id>https://blog.sofunnyai.com/2018/07/16/build-a-blog-base-hexo-github/</id>
    <published>2018-07-16T05:05:26.000Z</published>
    <updated>2020-05-20T07:15:39.489Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Why"><a href="#Why" class="headerlink" title="Why"></a>Why</h1><p>之前分别在csdn和cnblogs写了一些文章，csdn的广告越来越过分实在忍不了。然而cnblogs的markdown编辑器又太弱，一直也没什么更新，所以就再造一个轮子。</p><h1 id="What"><a href="#What" class="headerlink" title="What"></a>What</h1><ul><li><p>Hexo是个啥，这一套是怎么工作的？</p><ul><li>Hexo是一个基于Nodejs的渲染引擎，可以集成多个主题和插件，实现了内容和样式分离，可以根据喜好快速换装。</li><li>用户可以撰写一个markdown格式的博客文件，使用Hexo渲染为html格式</li><li>然后将html部署到github（或者自有服务器/vps等等）</li><li>使用github的pages服务（或者自有服务器的IP）即可访问我们的博客</li><li>可选：接着可以用我们的自有域名解析到github的pages服务即可（或者我们服务器的IP）</li></ul></li><li><p>搭建好了怎么写博客？</p><ul><li>本地写markdown格式，安利下typora，巨好用。</li><li>写完执行一个命令会自动渲染成html，再执行一个命令会自动部署到github，相当简单。</li></ul></li></ul><h1 id="How"><a href="#How" class="headerlink" title="How"></a>How</h1><p>把大象关进冰箱需要三步，搭建基于Hexo的博客也需要三步：</p><ul><li>安装Hexo，跑起来</li><li>搞一个Gayhub的repo，弄一个page.io</li><li>搞一个域名，DNS解析即可（如果需要加速，在CDN配置一下）</li></ul><h1 id="Details"><a href="#Details" class="headerlink" title="Details"></a>Details</h1><h2 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h2><ul><li><p>首选需要安装nodejs，安装cnpm</p><ul><li><p>选择操作系统的发行版:  </p><ul><li><blockquote><p><a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">https://nodejs.org/en/download/</a> </p></blockquote></li><li><p>我是linux，下载解压，配置环境变量，source一把即可。</p></li><li><p>windows用户更简单，下载后各种next即可。</p></li><li><p>mac和linux类似</p></li></ul></li><li><p>npm加速，安装cnpm：</p></li><li><p><code>npm install -g cnpm --registry=https://registry.npm.taobao.org</code></p></li></ul></li><li><p>安装Hexo：<code>cnpm install -g hexo</code> 会自动从gayhub下载hexo并安装</p></li><li><p>然后就进入目录去配置<code>_conifg.yml</code>,包括博客title、作者、语言等等</p><p><img src="../images/image-hexo-config.png" alt="image-20200520132503890"></p></li><li><p>运行 <code>hexo s</code>，然后去<code>http://localhost:4000</code>就能看到了。默认样式会有点丑，别着急看下一节。</p></li></ul><h3 id="选择主题"><a href="#选择主题" class="headerlink" title="选择主题"></a>选择主题</h3><ul><li>先戳这里，官方有巨多主题： <a href="https://hexo.io/themes/" target="_blank" rel="noopener">https://hexo.io/themes/</a></li><li>也可以去gayhub自己搜<code>hexo-theme</code>即可，也有n多</li><li>我一个老年大叔，选择了一个简单一点的主题<code>hexo-theme-pure</code>，这个<a href="https://github.com/cofess/hexo-theme-pure" target="_blank" rel="noopener">https://github.com/cofess/hexo-theme-pure</a>  主题的中文说明：<a href="https://github.com/cofess/hexo-theme-pure/blob/master/README.cn.md" target="_blank" rel="noopener">https://github.com/cofess/hexo-theme-pure/blob/master/README.cn.md</a></li><li>按照主题说明，clone到hexo的theme文件夹内，然后修改一下hexo的<code>_config.yml</code>文件中的主题<code>theme: pure</code></li><li>按照主题说明，安装主题渲染所需的nodejs插件。无非就是几个<code>cnpm install xxxx</code>即可</li><li>按照主题说明，配置主题的配置文件，一般在主题文件夹<code>./hexo/theme/pure</code>下的<code>_config.yml</code>（无非是颜色、元素是否显示、布局之类的），很简单看一眼就知道。</li><li>运行渲染<code>hexo clean &amp; hexo g &amp; hexo s</code>，分别是清理、生成、运行，然后再去<code>http://localhost:4000</code>看一眼，主题就生效了。</li></ul><h2 id="gayhub托管"><a href="#gayhub托管" class="headerlink" title="gayhub托管"></a>gayhub托管</h2><ul><li>我们<code>hexo g</code>渲染生成的静态文件在<code>public</code>文件夹内，需要把它丢到一个web容器内运行就可以了。gayhub提供githubpages服务可以托管静态文件，并可以http浏览。</li><li>所以去github新建一个repo，repo名字为<code>xxxx.github.io</code>,这个<strong>xxxx必须和你的github用户名一致!</strong></li><li>然后回到hexo中配置deploy模式为git，配置仓库地址为上面的repo地址。更多参见<a href="https://hexo.io/zh-cn/docs/github-pages" target="_blank" rel="noopener">https://hexo.io/zh-cn/docs/github-pages</a></li><li>配置完毕<code>hexo d</code>输入github账号密码即可push到服务器（如果本机没有保存，或者服务器配置秘钥的话，具体github配置公钥上网查找）</li><li>然后可以访问我们的博客了<code>https://</code>xxxx.github.io`</li></ul><h2 id="自定义域名-可选"><a href="#自定义域名-可选" class="headerlink" title="自定义域名[可选]"></a>自定义域名[可选]</h2><ul><li><p>上面虽然博客可以访问了，但是github.io看起来有点low，而且国内访问速度也很慢。</p></li><li><p>所以，我建议撸一个域名，挂博客，搞微信开发，内网穿透，扶墙等等用处多多。。。而且最好是境外服务商域名，境内的域名要备案、年检，非常非常麻烦。</p></li><li><p>目前最便宜的是戳这个：<a href="https://www.namesilo.com/?rid=85df914mk" target="_blank" rel="noopener">namesilo官网</a>，优势：</p><ul><li>他家的.com域名只要7.99刀，.xyy和.online域名只要0.99刀，简直白送！关键是续费便宜没有坑，别家有首年很便宜，后面续费巨贵的。</li><li>永久免费的whois隐私保护，其他家这个功能还要收费。</li><li>支持支付宝收款，不用别家还要信用卡或者PayPal</li><li>所以戳链接进去官网： <a href="https://www.namesilo.com/?rid=85df914mk" target="_blank" rel="noopener">www.namesilo.com/</a></li></ul></li><li><p>进入官网后，右上角注册sign up，输入用户名，邮箱，密码即可。</p></li><li><p>然后register，选择域名进行注册，第一次会让你填写信息（以免域名丢失找回，或者服务商后续通知一些域名相关事项）</p></li><li><p><img src="../images/image-namesilo-reg.png" alt="image-20200520140905968"></p></li><li><p>输入你想注册的域名，搜索，看看有没有被注册过：</p></li></ul><p><img src="../images/image-namesilo-reg2.png" alt="image-20200520142246492"></p><ul><li><p>假如你选择的没有被占用。点击下面的add加入购物车，然后checkout结算,我这里用.com的8.99刀域名举例（你也可以用下面0.99刀的，简直便宜到几乎白送！）</p><p><img src="../images/image-namesilo-reg3.png" alt="imagereg3"></p></li><li><p>结算页面，按图上选择即可，然后下面的打折码输入<strong><code>cutoff</code></strong> ，点击<code>submit</code>即可享受打折优惠！</p><p><img src="../images/image-namesilo-reg4.png" alt="image-20200520143429325"></p></li><li><p>下一步就是支付宝扫码付款即可。</p></li><li><p>付完款去account个人中心，点击domain manager域名管理，会出来你的域名列表。点击设置dns</p><p><img src="../images/image-namesilo-reg5.png" alt="reg5"></p></li><li><p>设置DNS,点击CNAME，会出来一条解析，可以根据喜好设置为www的主域名，还是blog.xxx.com的二级域名。目标设置我们上面个人的<code>xxxxxx.github.io</code>，提交即可。</p><p><img src="../images/image-namesilo-reg6.png" alt="img"></p></li></ul><p>搞定你以为大功告成了？还需要在github的repo里面设置这个域名，否则github会阻止域名解析，导致404。看下一节</p><ul><li><p>github配置域名：</p><ul><li>在那个<code>custom domain</code>填写你的域名，save一下</li></ul><p><img src="../images/image-namesilo-reg7.png" alt="image-20200520145606979"></p></li></ul><ul><li>然后在你本地的<code>hexo/source</code>目录下创建个<code>CNAME</code>文件夹，写上你的域名</li></ul><ul><li>最后，重新<code>hexo g &amp; hexo d</code></li></ul><p>此时即可用我们的域名访问。</p><h1 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h1><h3 id="评论管理"><a href="#评论管理" class="headerlink" title="评论管理"></a>评论管理</h3><p>关于博客的评论，一般来说是需要一个数据库的。但是我们是纯静态服务，所以有人搞了类似<a href="https://github.com/gitalk/gitalk" target="_blank" rel="noopener">gitalk</a>、<a href="https://github.com/imsun/gitment" target="_blank" rel="noopener">gitment</a> 这样的东西。只用前台引用js即可，一般都不用我们管，主题已经集成好了。只用按照说明进行配置几个参数即可。</p><h3 id="CDN加速-可选"><a href="#CDN加速-可选" class="headerlink" title="CDN加速[可选]"></a>CDN加速[可选]</h3><ul><li>想继续折腾访问速度的往下看：</li><li>首先，不推荐国内的CDN供应商和域名解析商，因为他们动不动就有合规要求。会折腾客户去备案（不是所有的）</li><li>然后，推荐cloudflare，也很简单，注册一个账号，在namesilo里面把CDN服务迁移到cloudflare即可。上网搜索巨多资料。</li></ul><h1 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h1><ul><li><p>为啥配置好了域名无法访问？</p><p>等待域名解析，尝试DNS那里的TTL设置小一点，刷新本地DNS缓存。</p></li><li><p>为啥速度不一般？</p><p>因为是国外DNS，可能第一次访问有点慢。有精力的尝试迁移到cloudflare，还有CDN加速，https，爽歪歪。戳这里：<a href="https://www.cloudflare.com/" target="_blank" rel="noopener">https://www.cloudflare.com/</a></p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Why&quot;&gt;&lt;a href=&quot;#Why&quot; class=&quot;headerlink&quot; title=&quot;Why&quot;&gt;&lt;/a&gt;Why&lt;/h1&gt;&lt;p&gt;之前分别在csdn和cnblogs写了一些文章，csdn的广告越来越过分实在忍不了。然而cnblogs的markdown编辑器又太弱
      
    
    </summary>
    
    
    
  </entry>
  
</feed>
